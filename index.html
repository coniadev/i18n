<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Introduction - Conia Cli</title>

    <link rel="shortcut icon" href="logo.svg">
    <link rel="mask-icon" href="logo.svg" color="#000000">

    <link rel="stylesheet" href="styles.css">



    <script src="highlight.min.js"></script>
    <script>hljs.highlightAll();</script>





    <script src="search/main.js"></script>

</head>

<body>
    <header class="mobile">
        <div class="logo">
            <a href="https://conia.dev">
                <img src="logo.svg" alt="Introduction - Conia Cli Logo">
            </a>
            Conia i18n
        </div>
        <div class="toc-link">
            <a href="#navigation">Jump to table of contents</a>
        </div>
    </header>
    <main>
        <aside id="navigation" class="pane">
            <div class="logo">
                <a href="https://conia.dev">
                    <img src="logo.svg" alt="Introduction - Conia Cli Logo">
                </a>
                Conia i18n
            </div>

            <div class="title">Table of Contents</div>

            <ul>
            
                <!--

-->

<li class="active">
    <a href=".">Introduction</a>
</li>

            
            </ul>

            <div class="title">Quick Search</div>

            <div role="search">
                <form action="search.html" method="get">
                <input type="search" name="q" placeholder="Search docs" />
                </form>
            </div>
        </aside>

        <article>
            <div>
            
                <h1 id="conia-gettext-tools">Conia <code>gettext</code> Tools</h1>
<div class="admonition warning">
<p class="admonition-title">Note</p>
<p>This i18n package is under active development, some of the listed features are still experimental and subject to change. Large parts of the documentation are missing. </p>
</div>
<p>Provides <code>conia/cli</code> commands which help to setup gettext files in a PHP project which uses <code>phpmyadmin/motranslator</code>. It extracts strings marked for translation from source code and  initializes, updates, and compiles <em>.po/</em>.mo files.</p>
<h2 id="requirements">Requirements:</h2>
<ul>
<li><strong>gettext</strong> to add the commandline po/mo tools like xgettext, msginit, msgfmt etc.</li>
<li><strong>po2json</strong> (if you need json files created from the *.po files)</li>
</ul>
<p>Install requirements on Debian/Ubuntu</p>
<pre><code>apt install gettext
</code></pre>
<p>If you additionally want to compile to json files, you need a node.js
installation and the npm package <code>gettext.js</code> either installed globally
or in the <code>node_modules</code> directory in the current working directory.</p>
<pre><code>npm install -g gettext.js
</code></pre>
<h2 id="usage">Usage:</h2>
<p>This helper provides four commands:</p>
<ul>
<li><strong>extract</strong>, which extracts translation function calls to *.pot file. Internally it calls <code>xgettext</code>. <strong>Note</strong>: it always overwrites the *.pot file.</li>
<li><strong>init</strong> initializes a language/locale and uses <code>msginit</code>.</li>
<li><strong>update</strong> updates existing *.po files according to the *.pot file with <code>msgmerge</code>.</li>
<li><strong>compile</strong> compiles the *.po files to *.mo files using <code>msgmerge</code>.</li>
</ul>
<h3 id="add-the-commands-to-your-runner-script">Add the commands to your runner script</h3>
<p>If you don't know what a runner script is, see <a href="https://conia.dev/cli/">conia/cli</a>.</p>
<pre><code class="language-php">&lt;?php 

require __DIR__ . '/vendor/autoload.php';

use Conia\Cli\Runner;
use Conia\I18n\I18n;
use Conia\I18n\Source;

$commands = I18n::commands(
    // The directory where the *.pot/*.po/*.mo files are created in
    dir: __DIR__ . '/locale',

    // The gettext domain
    domain: 'mydomain',

    // The sources from which the translation string are extracted
    // The last argument of the Source() constructor is the language
    // name used by the xgettext --language parameter. See:
    // https://www.gnu.org/software/gettext/manual/html_node/xgettext-Invocation.html
    sources: [
        new Source(__DIR__ . '/src', '*.php', 'PHP'),
        new Source(__DIR__ . '/frontend', '*.js', 'Javascript'),
    ],

    // If you want to create json files, add a path to an existing dir
    jsonDir: __DIR__ . '/public/locale',

    // Optional: add additional parameters for the gettext commands
    // Examples:
    params: [
        // php run i18n:extract
        'xgettext' =&gt; [
            '--force-po' =&gt; null,
            '--copyright-holder' =&gt; '&quot;ebene f├╝nf GmbH&quot;',
        ],
        // php run i18n:init
        'msginit' =&gt; [
            '--no-translator' =&gt; null,
        ],
        // php run i18n:update
        'msgmerge' =&gt; [
            '--no-fuzzy-matching' =&gt; null,
        ],
        // php run i18n:compile
        'msgfmt' =&gt; [
            '--check-header' =&gt; null,
        ],
        'po2json' =&gt; [
            'path' =&gt; '/path/to/po2json',
        ]
    ]
);

$runner = new Runner($commands);

exit($runner-&gt;run());
</code></pre>
<h3 id="how-to-use">How to use</h3>
<p>Initialize languages:</p>
<pre><code>php run i18n:extract
php run i18n:init --locale en
php run i18n:init --locale de
</code></pre>
<p>This creates the file <code>./locale/mydomain.pot</code> and the po files</p>
<ul>
<li><code>./locale/en/LC_MESSAGES/mydomain.po</code></li>
<li><code>./locale/de/LC_MESSAGES/mydomain.po</code></li>
</ul>
<p>Now you can translate the string by adding translations to the *.po files. When you
are done, you have to compile the *.po files to *.mo files:</p>
<pre><code>php run i18n:compile
</code></pre>
<p>After you add new strings to your source code, you have to extract again and then 
update the *.po files</p>
<pre><code>php run i18n:extract
php run i18n:update
# now translate the added strings by editing the updated po files
php run i18n:compile
</code></pre>
<p>It overrides the language specific options and keyword settings of <code>xgettext</code> to support
<code>phpmyadmin/motranslator</code> functions. The following function calls and their short forms will be extracted:</p>
<pre><code>_dgettext, _d
_dngettext, _dn
_dnpgettext, _dnp
_dpgettext, _dp
_gettext, __ (Note: a single underscore call will NOT be extracted)
_ngettext, _n
_npgettext, _np
_pgettext, _p
</code></pre>
            
            </div>
        </article>

        <aside class="toc desktop">
            <!-- github repo URL -->
            
                <a href="https://github.com/coniadev/i18n/edit/master/docs/index.md" class="github-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
                    Edit on GitHub
                </a>
            

            <div class="title">This Page</div>

            <ul>
            
                <li><a href="#conia-gettext-tools">Conia gettext Tools</a></li>
                
                    <li>
                        <a href="#requirements">Requirements:</a>
                        
                    </li>
                
                    <li>
                        <a href="#usage">Usage:</a>
                        
                            <ul>
                                
                                <li>
                                    <a href="#add-the-commands-to-your-runner-script">Add the commands to your runner script</a>
                                </li>
                                
                                <li>
                                    <a href="#how-to-use">How to use</a>
                                </li>
                                
                            </ul>
                        
                    </li>
                
            
            </ul>

            <div class="title">Navigate</div>

        
        </aside>
    </main>

    <footer>
        © 2022 ebene fünf GmbH |
        Built with <a href="https://www.mkdocs.org">MkDocs</a>.
    </footer>

  <!--
  MkDocs version      : 1.4.1
  Docs Build Date UTC : 2022-10-25 16:29:39.909243+00:00
  -->
</body>
</html>